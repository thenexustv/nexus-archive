---
import type { Person } from "../data/types";

interface Props {
  person: Person;
}

const { person } = Astro.props;

function stripHtml(html: string): string {
  return html.replace(/<[^>]*>/g, "");
}

const bioText = person.content ? stripHtml(person.content).trim() : "";
const bioPreview =
  bioText.length > 120 ? bioText.slice(0, 120).trimEnd() + "â€¦" : bioText;
---

<a
  href={`/people/${person.slug}/`}
  class="flex items-start gap-3 p-4 border border-gray-200 dark:border-stone-700 rounded-lg hover:border-gray-300 dark:hover:border-stone-600 hover:bg-gray-50 dark:hover:bg-stone-800 transition-colors shadow-sm"
>
  {person.gravatarUrl && (
    <img
      src={person.gravatarUrl}
      alt={person.name}
      width="48"
      height="48"
      class="rounded-full flex-shrink-0"
      loading="lazy"
    />
  )}
  <div>
    <div class="font-medium text-gray-900 dark:text-stone-100">{person.name}</div>
    <div class="mt-1 text-sm text-gray-500 dark:text-stone-400">
      {person.episodeCount} episode{person.episodeCount !== 1 ? "s" : ""}
    </div>
    {bioPreview && (
      <p class="mt-1 text-sm text-gray-600 dark:text-stone-300 line-clamp-2">{bioPreview}</p>
    )}
  </div>
</a>
